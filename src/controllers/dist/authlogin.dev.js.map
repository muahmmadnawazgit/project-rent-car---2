{"version":3,"sources":["authlogin.js"],"names":["bcrypt","require","con","exports","login","req","res","body","email","password","query","err","result","length","flash","redirect","verify","compareSync","session","id","name"],"mappings":";;AAAA,IAAIA,MAAM,GAAGC,OAAO,CAAC,UAAD,CAApB;;AACA,IAAIC,GAAG,GAAGD,OAAO,CAAC,UAAD,CAAjB;;AAEAE,OAAO,CAACC,KAAR,GAAgB,UAACC,GAAD,EAAMC,GAAN,EAAc;AAAA,kBAItBD,GAAG,CAACE,IAJkB;AAAA,MAEtBC,KAFsB,aAEtBA,KAFsB;AAAA,MAGtBC,QAHsB,aAGtBA,QAHsB;AAK1BP,EAAAA,GAAG,CAACQ,KAAJ,CAAU,mCAAV,EAA+C,CAACF,KAAD,CAA/C,EAAwD,UAAUG,GAAV,EAAeC,MAAf,EAAuB;AAC3E,QAAID,GAAJ,EAAS,MAAMA,GAAN;;AACT,QAAIC,MAAM,CAACC,MAAP,IAAiB,CAArB,EAAwB;AACpBR,MAAAA,GAAG,CAACS,KAAJ,CAAU,SAAV,EAAqB,2BAArB;AACA,aAAOR,GAAG,CAACS,QAAJ,CAAa,QAAb,CAAP;AACH,KAHD,MAGO,IAAIH,MAAM,CAACC,MAAP,IAAiBD,MAAM,CAAC,CAAD,CAAN,CAAUI,MAAV,IAAoB,CAAzC,EAA4C;AAC/CX,MAAAA,GAAG,CAACS,KAAJ,CAAU,SAAV,EAAqB,iCAArB;AACA,aAAOR,GAAG,CAACS,QAAJ,CAAa,QAAb,CAAP;AACH,KAHM,MAGA,IAAIH,MAAM,CAACC,MAAP,IAAiBb,MAAM,CAACiB,WAAP,CAAmBR,QAAnB,EAA6BG,MAAM,CAAC,CAAD,CAAN,CAAUH,QAAvC,CAArB,EAAuE;AAC1EJ,MAAAA,GAAG,CAACa,OAAJ,CAAYV,KAAZ,GAAoBA,KAApB;AACAH,MAAAA,GAAG,CAACa,OAAJ,CAAYC,EAAZ,GAAiBP,MAAM,CAAC,CAAD,CAAN,CAAUO,EAA3B;AACAd,MAAAA,GAAG,CAACS,KAAJ,CAAU,SAAV,qBAAiCF,MAAM,CAAC,CAAD,CAAN,CAAUQ,IAA3C;AACA,aAAOd,GAAG,CAACS,QAAJ,CAAa,UAAb,CAAP;AACH;AACJ,GAdD;AAeH,CApBD,C,CAqBA;AACA","sourcesContent":["var bcrypt = require('bcryptjs');\r\nvar con = require('../db.js');\r\n\r\nexports.login = (req, res) => {\r\n    const {\r\n        email,\r\n        password\r\n    } = req.body\r\n    con.query('SELECT * FROM users WHERE email=?', [email], function (err, result) {\r\n        if (err) throw err;\r\n        if (result.length <= 0) {\r\n            req.flash('message', 'Invalid Email or Password');\r\n            return res.redirect('/login')\r\n        } else if (result.length && result[0].verify == 0) {\r\n            req.flash('message', 'user not Verified please Verify');\r\n            return res.redirect('/login');\r\n        } else if (result.length && bcrypt.compareSync(password, result[0].password)) {\r\n            req.session.email = email;\r\n            req.session.id = result[0].id;\r\n            req.flash('message', `Welcome '${result[0].name}'`);\r\n            return res.redirect('/profile');\r\n        }\r\n    })\r\n};\r\n///email verification set in routes.js \r\n///email verification set in routes.js "],"file":"authlogin.dev.js"}