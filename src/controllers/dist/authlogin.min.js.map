{"version":3,"sources":["authlogin.js"],"names":["bcrypt","require","con","exports","login","req","res","_req$body","body","email","err","result","password","query","length","flash","redirect","verify","session","id","concat","compareSync"],"mappings":"aAAA,IAAIA,OAASC,QAAQ,YACjBC,IAAMD,QAAQ,YAElBE,QAAQC,MAAQ,SAACC,EAAKC,GAAQ,IAAAC,EAAAF,EAAAG,KAEtBC,EAFsBF,EAEtBE,MAFAL,EAAsBG,EAAtBH,SAAsBF,IAEtBO,MAFsB,oCAAA,CAAAA,GAAA,SAAAC,EAAAC,GAGtBC,GAAAA,EAHsB,MAAAF,EAKtBG,OAAMF,EAAAG,QAAA,GACNT,EAASU,MAAA,UAAA,6BAGET,EAAIU,SAAS,WAFbF,EAAXA,QAAwB,GAAAH,EAAA,GAAAM,QAChBF,EAAMA,MAAA,UAAW,mCACVC,EAAAA,SAAS,WACbL,EAAOG,QAAUH,OAAUM,YAAaL,EAAAD,EAAA,GAAAC,WAC3CG,EAAMG,QAAAT,MAAWA,EACrBJ,EAAUa,QAACF,GAASL,EAApB,GAAAQ,GACGd,EAAIM,MAAOG,UAAX,YAAAM,OAA4BC,EAAYT,GAAAA,KAAxC,MACSH,EAAZO,SAAA,kBAJOL","file":"authlogin.min.js","sourcesContent":["var bcrypt = require('bcryptjs');\r\nvar con = require('../db.js');\r\n\r\nexports.login = (req, res) => {\r\n    const {\r\n        email,\r\n        password\r\n    } = req.body\r\n    con.query('SELECT * FROM users WHERE email=?', [email], function (err, result) {\r\n        if (err) throw err;\r\n        if (result.length <= 0) {\r\n            req.flash('message', 'Invalid Email or Password');\r\n            return res.redirect('/login')\r\n        } else if (result.length && result[0].verify == 0) {\r\n            req.flash('message', 'user not Verified please Verify');\r\n            return res.redirect('/login');\r\n        } else if (result.length && bcrypt.compareSync(password, result[0].password)) {\r\n            req.session.email = email;\r\n            req.session.id = result[0].id;\r\n            req.flash('message', `Welcome '${result[0].name}'`);\r\n            return res.redirect('/profile');\r\n        }\r\n    })\r\n};\r\n///email verification set in routes.js \r\n///email verification set in routes.js "]}